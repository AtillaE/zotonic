digraph auth_worker {
    start -> check_sessionstate;

    check_sessionstate -> anonymous [label="session(anon)"];
    check_sessionstate -> authenticated [label="session(user)"];
    check_sessionstate -> check_autologon [label="no-session"];

    check_autologon -> authenticating [label="cookie-autologon"];

    anonymous -> authenticating [label="username/pw-form"];

    authenticating -> exchanging [label="auth-accept"];
    authenticating -> cleanup [label="auth-reject"];

    exchanging -> cleanup [label="cookie-uri-reject"];
    exchanging -> authenticated [label="cookie-uri-accept"];

    authenticated -> cleanup [label="logoff"];
    authenticated -> cleanup [label="mqtt-connack-reject"];

    authenticated -> authenticating [label="username/pw-form"];
    authenticated -> authenticated [label="cookie-extend-accept"];
    authenticated -> cleanup [label="cookie-extend-reject"];

    cleanup -> anonymous [label="cookie/session-removed"];
}
